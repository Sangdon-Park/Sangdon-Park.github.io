<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NKT8SV46');</script>
    <!-- End Google Tag Manager -->
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serena MCP Installation Guide - Sangdon Park</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Complete troubleshooting guide for Serena MCP installation issues with Claude Code. Solutions for web_dashboard settings, uv sync, and more.">
    <meta name="keywords" content="Serena MCP, Claude Code, MCP installation, AI coding tools, installation guide">
    <meta name="author" content="Sangdon Park">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Serena MCP Installation Guide">
    <meta property="og:description" content="Complete troubleshooting guide for Serena MCP installation issues">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://sangdon-park.github.io/articles/serena-mcp-guide-en.html">
    
    <link rel="stylesheet" href="../css/article.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKT8SV46"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="layout-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="profile-section">
                <a href="../en.html" style="text-decoration: none;">
                <img src="../images/Sangdon.jpg" alt="Sangdon Park" class="profile-avatar">
            </a>
                <h1 class="profile-name">Sangdon Park</h1>
                <p class="profile-title">Principal Researcher<br>@ Sayberry Games Inc.</p>
                
                
                <div class="social-links">
                    <a href="mailto:chaos@sayberrygames.com" class="social-link" aria-label="Email">
                        <i class="fas fa-envelope"></i>
                    </a>
                    <a href="https://github.com/Sangdon-Park" class="social-link" target="_blank" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://www.linkedin.com/in/sangdon/" class="social-link" target="_blank" aria-label="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://scholar.google.com/citations?user=JZFDtsgAAAAJ&hl=en" class="social-link" target="_blank" aria-label="Google Scholar">
                        <i class="fas fa-graduation-cap"></i>
                    </a>
                </div>
            </div>
            
            <nav class="nav-section">
                <div class="nav-title">Navigation</div>
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="../en.html#posts" class="nav-link">
                            <i class="fas fa-home"></i> Posts
                        </a>
                    </li>
                    
                    
                </ul>
            </nav>
            
            <nav class="nav-section">
                <div class="nav-title">About</div>
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="../en.html#research" class="nav-link">
                            <i class="fas fa-flask"></i> Research
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../en.html#experience" class="nav-link">
                            <i class="fas fa-briefcase"></i> Experience & Education
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../en.html#projects" class="nav-link">
                            <i class="fas fa-project-diagram"></i> Projects
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../en.html#publications" class="nav-link">
                            <i class="fas fa-book"></i> Publications
                        </a>
                    </li>
                    
                </ul>
            </nav>
            
            <!-- Language Toggle -->
            <div class="language-toggle" style="padding: 20px; border-top: 1px solid var(--border);">
                <a href="serena-mcp-guide-en.html" class="lang-btn active" style="display: inline-block; padding: 8px 16px; background: var(--accent); color: white; border: 1px solid var(--accent); border-radius: 5px; text-decoration: none;">EN</a>
                <a href="serena-mcp-guide.html" class="lang-btn" style="display: inline-block; padding: 8px 16px; background: var(--card-bg); color: var(--text); border: 1px solid var(--border); border-radius: 5px; text-decoration: none; margin-left: 10px;">KO</a>
            </div>
        </aside>
        
        <!-- Mobile Toggle -->
        <button class="mobile-toggle" id="mobile-toggle">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Main Content -->
        <main class="main-content">
            <a href="../en.html#posts" class="back-to-posts">
                <i class="fas fa-arrow-left"></i>
                <span>Back to Posts</span>
            </a>
            
            <article class="article-container">
                <header class="article-header">
                    <span class="article-category">AI</span>
                    <h1 class="article-title">Serena MCP Installation Guide</h1>
                    <div class="article-meta">
                        <span class="article-date">
                            <i class="far fa-calendar"></i> August 14, 2025
                        </span>
                        <span class="article-reading-time">
                            <i class="far fa-clock"></i> 15 min read
                        </span>
                    </div>
                </header>
                
                <div class="article-content">
                    <h2>Overview</h2>
                    <p>This document covers all known issues and solutions encountered during Serena MCP installation. Based on 5 hours of troubleshooting and references from <a href="https://hansdev.kr/tech/serena-mcp/" target="_blank" rel="noopener noreferrer">Chris Han's blog post</a>.</p>

                    <h2>Key Requirements</h2>
                    <ol>
                        <li><strong>web_dashboard: false</strong> - Installation fails without this setting.</li>
                        <li><strong>uv sync</strong> - Dependency installation is mandatory.</li>
                        <li><strong>Global ~/.claude.json</strong> - Must use global settings, not project-specific.</li>
                    </ol>

                    <h2>Common Installation Failures</h2>
                    
                    <h3>Case 1: Official Documentation Method</h3>
                    <pre><code>uvx --from serena-agent serena-mcp-server</code></pre>
                    <p><strong>Result</strong>: Command `serena-mcp-server` not found</p>
                    
                    <h3>Case 2: PyPI Package Installation</h3>
                    <pre><code>uv tool install serena-agent</code></pre>
                    <p><strong>Result</strong>: Installs but no executable found</p>
                    
                    <h3>Case 3: Wrong Command</h3>
                    <pre><code>uvx --from serena-agent serena start-mcp-server</code></pre>
                    <p><strong>Result</strong>: Connection failure in Claude</p>
                    
                    <h3>Case 4: Direct GitHub Installation</h3>
                    <pre><code>uvx --from git+https://github.com/oraios/serena serena-mcp-server</code></pre>
                    <p><strong>Result</strong>: Still connection failure</p>
                    
                    <h3>Case 5: Missing Web Dashboard Setting</h3>
                    <p><strong>Result</strong>: MCP communication failure - stdout/stderr pollution blocks JSON-RPC</p>

                    <h2>Root Cause Analysis</h2>
                    
                    <h3>Cause 1: PyPI Package Version Issues</h3>
                    <ul>
                        <li>PyPI's `serena-agent` is outdated</li>
                        <li>Latest version only exists in GitHub repository</li>
                        <li>GitHub version documentation also partially incorrect</li>
                    </ul>
                    
                    <h3>Cause 2: Web Dashboard Interference (Top Priority)</h3>
                    <ul>
                        <li>`web_dashboard: True` is set as default</li>
                        <li>Web dashboard outputs logs to stdout/stderr, interfering with MCP</li>
                        <li>Claude requires pure JSON-RPC communication but logs are mixed</li>
                        <li><strong>Required: Set `web_dashboard: false`</strong></li>
                    </ul>
                    
                    <h3>Cause 3: Missing Dependency Installation</h3>
                    <ul>
                        <li>Failure when `uv sync` not executed after `git clone`</li>
                        <li>55 essential packages must be installed</li>
                        <li>Command exists but won't execute without this step</li>
                    </ul>

                    <h2>Correct Installation Steps</h2>
                    
                    <h3>Prerequisites</h3>
                    <h4>macOS/Linux</h4>
                    <pre><code># Check Python 3.8+
python3 --version

# Check Git
git --version

# Install uv (Python package manager)
# Using Homebrew (macOS)
brew install uv

# Or official install script (Linux/macOS)
curl -LsSf https://astral.sh/uv/install.sh | sh

# Verify installation
uv --version</code></pre>
                    
                    <h4>Windows (WSL2 recommended)</h4>
                    <pre><code># In WSL2 use Linux commands
# Or in Windows PowerShell
winget install astral-sh.uv</code></pre>
                    
                    <h3>Step 1: Remove Existing Installation</h3>
                    <pre><code># Check and kill running processes
ps aux | grep serena
# kill [PID]

# Remove uv tools
uv tool uninstall serena-agent 2>/dev/null || echo "Not installed"

# Delete config files
rm -rf ~/.serena
rm -rf .serena

# Delete executables
rm -f ~/.local/bin/serena*

# Clear cache
find ~/.local/share/uv -name "*serena*" -exec rm -rf {} + 2>/dev/null

# Remove existing clone
rm -rf ~/work/serena</code></pre>
                    
                    <h3>Step 2: Local Installation</h3>
                    <pre><code># Create working directory
mkdir -p ~/work
cd ~/work

# Clone latest version from GitHub
git clone https://github.com/oraios/serena
cd serena

# Important: Install dependencies (required)
uv sync

# Verify success (55 packages installed)
# Installed 55 packages in XXXms</code></pre>
                    
                    <h3>Step 3: Configure Settings</h3>
                    <pre><code># Create config directory
mkdir -p ~/.serena

# Copy template
cp src/serena/resources/serena_config.template.yml ~/.serena/serena_config.yml

# Required: Disable web dashboard
sed -i 's/web_dashboard: True/web_dashboard: false/g' ~/.serena/serena_config.yml
sed -i 's/web_dashboard_open_on_launch: True/web_dashboard_open_on_launch: false/g' ~/.serena/serena_config.yml

# Or manually edit:
# web_dashboard: false
# web_dashboard_open_on_launch: false</code></pre>
                    
                    <h3>Step 4: Claude Configuration</h3>
                    <p>Create a Python script to automate configuration:</p>
                    <pre><code># setup_serena.py
import json
import os
import sys

claude_config = os.path.expanduser('~/.claude.json')

if not os.path.exists(claude_config):
    print("Error: ~/.claude.json not found. Run Claude Code first.")
    sys.exit(1)

with open(claude_config, 'r') as f:
    data = json.load(f)

# Add to global settings
if 'mcpServers' not in data:
    data['mcpServers'] = {}

data['mcpServers']['serena'] = {
    'type': 'stdio',
    'command': 'uv',
    'args': [
        'run',
        '--directory',
        os.path.expanduser('~/work/serena'),
        'serena-mcp-server',
        '--context',
        'ide-assistant'
    ],
    'env': {}
}

# Remove project-specific duplicates
removed_count = 0
for project_path, project_config in data.get('projects', {}).items():
    if 'mcpServers' in project_config and 'serena' in project_config['mcpServers']:
        del project_config['mcpServers']['serena']
        removed_count += 1
        print(f"Removed duplicate Serena config from {project_path}")

with open(claude_config, 'w') as f:
    json.dump(data, f, indent=2)

print(f"\nClaude configuration complete.")
print(f"Serena path: {os.path.expanduser('~/work/serena')}")
if removed_count > 0:
    print(f"Removed {removed_count} duplicate configurations")
print("\nRestart Claude Code now:")
print("1. Exit with Ctrl+C or /exit")
print("2. Restart with: claude --resume")
print("3. Verify with: /mcp")</code></pre>
                    
                    <p>Run the script:</p>
                    <pre><code>python3 setup_serena.py</code></pre>
                    
                    <h3>Step 5: Verify and Restart Claude</h3>
                    <pre><code># Check configuration
grep -A 10 '"serena"' ~/.claude.json

# Test JSON-RPC
cd ~/work/serena
echo '{"jsonrpc":"2.0","method":"initialize","params":{"capabilities":{}},"id":1}' | \
  uv run serena-mcp-server --context ide-assistant 2>/dev/null | head -5

# Restart Claude
# Exit with Ctrl+C or /exit
claude --resume

# Check MCP status
/mcp
# Should show: serena: Connected</code></pre>

                    <h2>Essential Guidelines</h2>
                    
                    <h3>DO NOT:</h3>
                    <ol>
                        <li>Use `uvx --from serena-agent`</li>
                        <li>Use `serena start-mcp-server` (starts web dashboard)</li>
                        <li>Use PyPI package (outdated)</li>
                        <li>Use project-specific .claude.json settings</li>
                        <li>Set `web_dashboard: True`</li>
                        <li>Skip `uv sync`</li>
                    </ol>
                    
                    <h3>MUST DO:</h3>
                    <ol>
                        <li>Clone directly from GitHub</li>
                        <li>Install dependencies with `uv sync`</li>
                        <li>Set `web_dashboard: false`</li>
                        <li>Use `uv run --directory`</li>
                        <li>Configure global ~/.claude.json</li>
                        <li>Remove duplicate configurations</li>
                    </ol>

                    <h2>Troubleshooting</h2>
                    
                    <h3>For "Failed to connect" errors:</h3>
                    <ol>
                        <li><strong>Check web_dashboard setting</strong> (top priority)
                            <pre><code>grep web_dashboard ~/.serena/serena_config.yml</code></pre>
                        </li>
                        <li><strong>Verify dependency installation</strong>
                            <pre><code>cd ~/work/serena && uv sync</code></pre>
                        </li>
                        <li>Check running Serena processes
                            <pre><code>ps aux | grep serena</code></pre>
                        </li>
                        <li>Check ~/.claude.json for duplicates</li>
                        <li>Verify local clone path</li>
                        <li>Confirm Claude restart</li>
                    </ol>

                    <h2>References</h2>
                    <ul>
                        <li><a href="https://github.com/oraios/serena" target="_blank">Serena GitHub Repository</a></li>
                        <li><a href="https://hansdev.kr/tech/serena-mcp/" target="_blank">hansdev.kr Serena MCP Guide</a></li>
                        <li><a href="https://docs.anthropic.com/en/docs/claude-code" target="_blank">Claude Code Documentation</a></li>
                        <li><a href="https://modelcontextprotocol.io" target="_blank">MCP Protocol Specification</a></li>
                    </ul>

                    <h2>Conclusion</h2>
                    <p>Serena MCP is a powerful tool, but web dashboard settings and dependency installation are crucial for successful installation.</p>
                    
                    <p><strong>Essential checks:</strong></p>
                    <ol>
                        <li>`web_dashboard: false`</li>
                        <li>`uv sync` executed</li>
                        <li>Global settings used</li>
                    </ol>
                    
                    <p>Following this guide precisely will lead to successful installation.</p>
                </div>
                
                <footer class="article-footer">
                    <div class="article-tags">
                        <a href="#" class="article-tag">Serena MCP</a>
                        <a href="#" class="article-tag">Claude Code</a>
                        <a href="#" class="article-tag">Installation Guide</a>
                        <a href="#" class="article-tag">AI Tools</a>
                    </div>
                </footer>
            </article>
        </main>
    </div>
    
    
    <script>
        // Mobile Toggle
        const mobileToggle = document.getElementById('mobile-toggle');
        const sidebar = document.getElementById('sidebar');
        
        if (mobileToggle && sidebar) {
            mobileToggle.addEventListener('click', () => {
                sidebar.classList.toggle('open');
            });
        }
    </script>
</body>
</html>